import{as as N,r as L,o as c,b as k,d as r,t as j,F as y,ar as B,u as s,at as G,au as U,g as x,av as b,c as I,e as q,f as P,aw as p,B as C,a as S,ax as O}from"./index-Ce41ocDD.js";import{u as V}from"./OriginLIst-BkThXzi-.js";import{P as E}from"./PlusOutlined-BFDY32tQ.js";import{A as w}from"./request-CDtsqYAV.js";const $={class:"title"},R={class:"adinner"},T=["onClick"],z=["src"],M=["onUpdate:modelValue"],X={class:"uploadFile"},H=["index"],J={__name:"adOriginInner",props:{data:{type:Object,default:()=>{}}},emits:["save","getDelImg","getNewAddImgSrc"],setup(d,{emit:u}){let i=L(!1);const _={1:"三人行主页焦点图",2:"家乡美主页焦点图"};let m=d,g=u,v=(e,t)=>{let a=new FormData;a.append("currencyFile",e),V(a).then(({code:n,message:o})=>{n==200?(g("getNewAddImgSrc",{type:t,src:o}),p.success("接口上传成功")):p.error("接口上传失败！"),i.value=!1})},f=e=>{i.value=!0;let t=e.target.getAttribute("index"),a=e.target.files[0];if(!a)return!1;if(a.size/1024/1024>1)return p.error("不可以上传超过1mb的图！"),!1;v(a,t)},h=()=>{g("save",m.data.queryFlag)},l=e=>{g("getDelImg",{type:m.data.queryFlag,index:e})};return(e,t)=>{const a=C;return c(),k(y,null,[r("h2",$,j(_[d.data.queryFlag]),1),r("ul",R,[(c(!0),k(y,null,B(d.data.list,(n,o)=>(c(),k("li",null,[r("span",{class:"del",onClick:A=>s(l)(o)},"x",8,T),r("img",{src:n.url},null,8,z),G(r("input",{type:"text","onUpdate:modelValue":A=>n.link=A,placeholder:"跳转链接"},null,8,M),[[U,n.link]])]))),256)),r("li",null,[r("div",X,[r("label",null,[r("input",{type:"file",accept:"image/png, image/jpeg, image/jpg",style:{display:"none"},index:d.data.queryFlag,onChange:t[0]||(t[0]=(...n)=>s(f)&&s(f)(...n))},null,40,H),s(i)?(c(),x(s(b),{key:0})):(c(),x(s(E),{key:1}))])])])]),I(a,{class:"btn",type:"primary",onClick:s(h)},{default:q(()=>[P("保存")]),_:1},8,["onClick"])],64)}}},F=N(J,[["__scopeId","data-v-303e8830"]]);let K=()=>w.get("https://css2-uat.tata.com.cn/mall/currency/queryPageAdvertising"),Q=d=>w({method:"get",url:"https://css2-uat.tata.com.cn/mall/currency/editPageAdvertising",params:d});const te={__name:"AdOrigin",setup(d){let u=S({queryFlag:1,pageAdvertisingUrl:[],pageAdvertisingLink:[],list:[]}),i=S({queryFlag:2,pageAdvertisingUrl:[],pageAdvertisingLink:[],list:[]});O((l,e,t)=>{confirm("如果您不点击保存按钮，新添加的图片则会丢失哦！，是否要真的离开？")?t():t(!1)});function _(l,e,t){t.list=[],e.forEach((a,n)=>{t.list.push({url:a,link:l[n]||""})})}const m=()=>K().then(({code:l,data:e})=>{if(l!==200){p.error("请求错误！");return}let[t,a]=e||[],n=t.pageAdvertisingLink.split(","),o=t.pageAdvertisingUrl.split(",");_(n,o,u);let A=a.pageAdvertisingLink.split(","),D=a.pageAdvertisingUrl.split(",");_(A,D,i)});m();function g(l){let{list:e,...t}=l,a=[],n=[];return e.forEach(o=>{a.push(o.url),n.push(o.link)}),t.pageAdvertisingUrl=a.join(","),t.pageAdvertisingLink=n.join(","),t}let v=l=>{let e=null;l==1?e=g(u):e=g(i),Q(e).then(({code:t})=>{t==200?(p.success("保存成功！"),m()):p.error("保存失败！")})},f=({type:l,src:e})=>{l==1?u.list.push({url:e,link:""}):i.list.push({url:e,link:""})},h=({index:l,type:e})=>{e==1?u.list.splice(l,1):i.list.splice(l,1)};return(l,e)=>(c(),k(y,null,[I(F,{onSave:s(v),onGetNewAddImgSrc:s(f),data:s(u),onGetDelImg:s(h)},null,8,["onSave","onGetNewAddImgSrc","data","onGetDelImg"]),I(F,{onSave:s(v),data:s(i),onGetDelImg:s(h),onGetNewAddImgSrc:s(f)},null,8,["onSave","data","onGetDelImg","onGetNewAddImgSrc"])],64))}};export{te as default};
